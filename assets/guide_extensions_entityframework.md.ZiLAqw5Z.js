import{_ as n,o as l,c as h,ag as a,j as s,t as e,a as p}from"./chunks/framework.BsQ5nXLq.js";const w=JSON.parse('{"title":"Entity Framework","description":"","frontmatter":{},"headers":[],"relativePath":"guide/extensions/entityframework.md","filePath":"guide/extensions/entityframework.md"}'),r={name:"guide/extensions/entityframework.md"},k={class:"language-shell vp-adaptive-theme"},o={class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},d={class:"line"},y={style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},g={class:"language-shell vp-adaptive-theme"},E={class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},c={class:"line"},m={style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}};function F(t,i,u,b,C,f){return l(),h("div",null,[i[8]||(i[8]=a('<h1 id="entity-framework" tabindex="-1">Entity Framework <a class="header-anchor" href="#entity-framework" aria-label="Permalink to &quot;Entity Framework&quot;">​</a></h1><h2 id="gridify-entityframework-package" tabindex="-1">Gridify.EntityFramework Package <a class="header-anchor" href="#gridify-entityframework-package" aria-label="Permalink to &quot;Gridify.EntityFramework Package&quot;">​</a></h2><p>The <code>Gridify.EntityFramework</code> package has two additional <code>GridifyAsync()</code> and <code>GridifyQueryableAsync()</code> methods.</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><h3 id="package-manager" tabindex="-1">Package Manager <a class="header-anchor" href="#package-manager" aria-label="Permalink to &quot;Package Manager&quot;">​</a></h3>',5)),s("div",k,[i[3]||(i[3]=s("button",{title:"Copy Code",class:"copy"},null,-1)),i[4]||(i[4]=s("span",{class:"lang"},"shell",-1)),s("pre",o,[s("code",null,[s("span",d,[i[0]||(i[0]=s("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Install-Package",-1)),i[1]||(i[1]=s("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," Gridify.EntityFramework",-1)),i[2]||(i[2]=s("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -Version",-1)),s("span",y," "+e(t.$version),1)])])])]),i[9]||(i[9]=s("h3",{id:"net-cli",tabindex:"-1"},[p(".NET CLI "),s("a",{class:"header-anchor",href:"#net-cli","aria-label":'Permalink to ".NET CLI"'},"​")],-1)),s("div",g,[i[6]||(i[6]=s("button",{title:"Copy Code",class:"copy"},null,-1)),i[7]||(i[7]=s("span",{class:"lang"},"shell",-1)),s("pre",E,[s("code",null,[s("span",c,[i[5]||(i[5]=a('<span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dotnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Gridify.EntityFramework</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span>',5)),s("span",m," "+e(t.$version),1)])])])]),i[10]||(i[10]=a(`<h2 id="compatibility-layer" tabindex="-1">Compatibility layer <a class="header-anchor" href="#compatibility-layer" aria-label="Permalink to &quot;Compatibility layer&quot;">​</a></h2><p>If you want to use gridify with Entity Framework, you should enable the compatibility layer:</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GridifyGlobalConfiguration.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EnableEntityFrameworkCompatibilityLayer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div><p>Enabling the compatibility layer provides the following features:</p><ul><li>It tweaks the internal expression builder to make it compatible with Entity Framework.</li><li>EF query optimization</li><li>EF ServiceProviderCaching support</li><li>Creates parameterized queries</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DECLARE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @__Value_0 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">nvarchar</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> N&#39;vahid&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [u].[Id], [u].[CreateDate], [u].[FkGuid], [u].[Name]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [Users] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [u]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [u].[Name] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> @__Value_0</span></span></code></pre></div><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><h3 id="entityframeworkcompatibilitylayer" tabindex="-1">EntityFrameworkCompatibilityLayer <a class="header-anchor" href="#entityframeworkcompatibilitylayer" aria-label="Permalink to &quot;EntityFrameworkCompatibilityLayer&quot;">​</a></h3><p>Setting this property to <code>true</code> Enables the EntityFramework Compatibility layer to make the generated expressions compatible with entity framework.</p><ul><li>type: <code>bool</code></li><li>default: <code>false</code></li></ul><h3 id="enableentityframeworkcompatibilitylayer" tabindex="-1">EnableEntityFrameworkCompatibilityLayer() <a class="header-anchor" href="#enableentityframeworkcompatibilitylayer" aria-label="Permalink to &quot;EnableEntityFrameworkCompatibilityLayer()&quot;">​</a></h3><p>Simply sets the <a href="#entityframeworkcompatibilitylayer">EntityFrameworkCompatibilityLayer</a> property to <code>true</code>.</p><h3 id="disableentityframeworkcompatibilitylayer" tabindex="-1">DisableEntityFrameworkCompatibilityLayer() <a class="header-anchor" href="#disableentityframeworkcompatibilitylayer" aria-label="Permalink to &quot;DisableEntityFrameworkCompatibilityLayer()&quot;">​</a></h3><p>Simply sets the <a href="#entityframeworkcompatibilitylayer">EntityFrameworkCompatibilityLayer</a> property to <code>false</code>.</p><h2 id="composite-maps-compatibility" tabindex="-1">Composite Maps Compatibility <a class="header-anchor" href="#composite-maps-compatibility" aria-label="Permalink to &quot;Composite Maps Compatibility&quot;">​</a></h2><p>When using <a href="./../gridifyMapper#addcompositemap">composite maps</a> with Entity Framework (especially PostgreSQL), follow these guidelines for optimal compatibility:</p><h3 id="working-with-different-data-types" tabindex="-1">Working with Different Data Types <a class="header-anchor" href="#working-with-different-data-types" aria-label="Permalink to &quot;Working with Different Data Types&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">Guid Properties</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ Recommended for EF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCompositeMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.FkGuid.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ToString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(),  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Convert to string</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Name);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ Not recommended for EF (may cause translation issues)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCompositeMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)x.FkGuid,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Name);</span></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">Numeric Properties</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ Recommended for EF</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCompositeMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Name,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Id.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ToString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">());  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Convert to string</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ Not recommended for EF (may cause type mismatch)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">mapper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCompositeMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Name,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)x.Id);</span></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">DateTime Properties (PostgreSQL)</p><div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ✅ Required for PostgreSQL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mapper</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GridifyMapper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cfg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cfg.DefaultDateTimeKind </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DateTimeKind.Utc)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AddCompositeMap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x.Name,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)x.CreateDate);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ❌ Without UTC configuration, PostgreSQL will throw an error</span></span></code></pre></div></div><h3 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h3><ol><li><strong>Use <code>.ToString()</code> for type consistency</strong> - When combining different property types (string, numeric, Guid), convert them all to strings</li><li><strong>Set UTC DateTimeKind for PostgreSQL</strong> - Configure <code>DefaultDateTimeKind = DateTimeKind.Utc</code> when working with DateTime properties</li><li><strong>Test with <code>.ToQueryString()</code></strong> - Verify EF can translate your expressions to SQL:<div class="language-csharp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">csharp</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sql</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbContext.Users</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ApplyFiltering</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;search=value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, mapper)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ToQueryString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre></div></li><li><strong>Keep types homogeneous</strong> - When possible, map properties of the same type together for better performance</li></ol>`,22))])}const A=n(r,[["render",F]]);export{w as __pageData,A as default};
